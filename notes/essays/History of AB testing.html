<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-07-31">
<meta name="description" content="Видение того, как развивались и будут развиваться рандомизированные тесты">

<title>History of AB – Pablo Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../resources/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b916b7f198a76df60a000b13a3477f81.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-0202a8281d25de7a9b3f625c81eb5e8f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JJNXYRZ5C4"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JJNXYRZ5C4', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../resources/styles.css">
<meta property="og:title" content="History of AB – Pablo Science">
<meta property="og:description" content="Видение того, как развивались и будут развиваться рандомизированные тесты">
<meta property="og:image" content="https://pavelbaboshkin.github.io/notes/essays/quarto.png">
<meta property="og:site_name" content="Pablo Science">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../notes/index.html" aria-current="page"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://t.me/PavelBaboshkin_channel"> <i class="bi bi-telegram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../notes/index.html">📚 Pablo Notes</a></li><li class="breadcrumb-item"><a href="../../notes/essays/index.html">Free essays</a></li><li class="breadcrumb-item"><a href="../../notes/essays/History of AB testing.html">History of AB</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../notes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">📚 Pablo Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../notes/essays/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Free essays</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/essays/History of AB testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">History of AB</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../notes/books/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/Agent of Influence by Janson Hanson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Agent of Influence by Janson Hanson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/Data for the People by Andreas Wiegend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data for the People by Andreas Wiegend</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/Games People Play by Eric Berne.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Games People Play by Eric Berne</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/How to see George Nelson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to see George Nelson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/Summa Technologiae by Stanislaw Lem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summa Technologiae by Stanislaw Lem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/The Autobiography of Benjamin Franklin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Autobiography of Benjamin Franklin</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/books/The Road to Serfdom by Friedrich Hayek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Road to Serfdom by Friedrich Hayek</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#этап-1-наивные-эксперименты" id="toc-этап-1-наивные-эксперименты" class="nav-link" data-scroll-target="#этап-1-наивные-эксперименты">Этап 1 – “наивные эксперименты”</a></li>
  <li><a href="#этап-2-рандомизация" id="toc-этап-2-рандомизация" class="nav-link" data-scroll-target="#этап-2-рандомизация">Этап 2 – рандомизация</a></li>
  <li><a href="#этап-3-измеряем-случайность" id="toc-этап-3-измеряем-случайность" class="nav-link" data-scroll-target="#этап-3-измеряем-случайность">Этап 3 – измеряем случайность</a></li>
  <li><a href="#этап-4-улучшаем-случайность" id="toc-этап-4-улучшаем-случайность" class="nav-link" data-scroll-target="#этап-4-улучшаем-случайность">Этап 4 – улучшаем случайность</a></li>
  <li><a href="#этап-5-прогнозная-оптимизация" id="toc-этап-5-прогнозная-оптимизация" class="nav-link" data-scroll-target="#этап-5-прогнозная-оптимизация">Этап 5 – прогнозная оптимизация</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../notes/index.html">📚 Pablo Notes</a></li><li class="breadcrumb-item"><a href="../../notes/essays/index.html">Free essays</a></li><li class="breadcrumb-item"><a href="../../notes/essays/History of AB testing.html">History of AB</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">History of AB</h1>
  <div class="quarto-categories">
    <div class="quarto-category">essay</div>
    <div class="quarto-category">AB testing</div>
    <div class="quarto-category">statistics</div>
  </div>
  </div>

<div>
  <div class="description">
    Видение того, как развивались и будут развиваться рандомизированные тесты
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 31, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>Вот читаю современные статьи от каких-нибудь microsoft research или других крутых ребят и поражаюсь как далеко люди заходят в попытке ответить на вопросы из сферы причин, следствий и размера эффекта. Вот я и решил разобраться в том, какие этапы развития мысли мы прошли на пути к современным рандомизированным экспериментам, чем и поделюсь в этом эссе.</p>
<p>Прежде чем рассматривать историю AB, приведу небольшой рекап по тому, что это такое и зачем надо. Пожалуй, в любой сфере полезно понимать какие факторы на что и как сильно влияют. В терминах исследований это звучит как-то так: мы хотим знать насколько изменится показатель X у подопытного, если он получит некоторое воздействие T, в сравнении с состоянием, когда он это воздействие не получает. Подопытным, метрикой и воздействием, может быть что угодно, но основная идея сохранится в духе того, что написано выше.</p>
<p>Вроде все легко, можно взять двух похожих подопытных, на одного влиять, другого не трогать и снять нужное нам измерение. Но это не сработает, потому что в мире слишком много факторов, которые мы не можем контролировать, чтобы считать измерения двух разных объектов или в разное время – сравнимыми. Получается, основная проблема на пути к нашей цели, в том, что один и тот же объект не может одновременно быть в двух разных состояниях. Это называется “фундаментальная проблема причинно-следственного анализа”.</p>
<p>Для закрепления приведу табличку, которая некогда мне очень помогла:</p>
<p>Пусть X – подопытный объект, T{0/1} – индикатор того, было ли на объект воздействие, Y – некоторая метрика, которую мы хотим оценить, тогда мы для оценки эффекта мы должны заполнить такую табличку:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 23%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Индекс подопытного <span class="math inline">\(X_i\)</span></th>
<th style="text-align: left;">Значение, если было влияние <span class="math inline">\(Y|T=1\)</span></th>
<th style="text-align: right;">Значение, если влияния не было <span class="math inline">\(Y|T=0\)</span></th>
<th style="text-align: center;">Эффект от влияния</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">???</td>
<td style="text-align: center;">1 - ???</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: left;">???</td>
<td style="text-align: right;">2</td>
<td style="text-align: center;">??? - 2</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: left;">???</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: center;">??? - 1.4</td>
</tr>
</tbody>
</table>
<p>Так проблему видно “в лицо”, ведь мы хотим получить разницу между тем когда есть воздействие и тем, когда его нет, но у нас не хватает данных. По сути, история развития экспериментов это история попыток как можно точнее оценивать пропущенные значения. Основные вехи в решении этой проблемы и конкретные переломные моменты я и попробую описать ниже, структурно я поделил историю вопроса на 5 этапов:</p>
<ul>
<li>“наивные эксперименты”<br>
</li>
<li>рандомизация<br>
</li>
<li>измеряем случайность<br>
</li>
<li>улучшаем случайность<br>
</li>
<li>прогнозная оптимизация</li>
</ul>
<p>Теперь разберем каждый подробнее.</p>
</section>
<section id="этап-1-наивные-эксперименты" class="level2">
<h2 class="anchored" data-anchor-id="этап-1-наивные-эксперименты">Этап 1 – “наивные эксперименты”</h2>
<p>Тут особо нечего говорить о каких-то систематических достижениях в области тестов, потому что их, по сути, и не было. Люди просто наблюдали явления, описывали их и наблюдаемое брали за оценку эффекта. Эффективность таких исследований низкая, потому что понятным образом отделить, где результат полностью случайный, а где нет – нельзя.</p>
<p>С философской точки зрения хочется сказать, что смысл в таких экспериментах все равно был, просто валидация результата была не через контролируемую среду эксперимента, а через реальность, поэтому через время сохранялись наиболее соответствующие реальности результаты.</p>
<p>Приведу несколько занимательных фактов и идей, времен этого периода:</p>
<ul>
<li>Начала теории вероятности можно встретить в работах древних греков в 5 веке до нашей эры. Фукидид описывает как афиняне посчитали с с помощью наблюдений нескольких солдат высоту вражеской стены.</li>
<li>Описанные подходы к вычислению арифметического среднего и медианы появились только в 16 веке.</li>
<li>Ньютон в своих началах (17 век) для доказательств использует просто описание увиденных явлений (по сути во всех науках так было до изобретения статистических тестов, но этот пример меня особенно поразил)</li>
<li>Термин “статистика” – появился в 17 веке и долгое время в задачи статистики входил только сбор, систематизация и описание социально-демографических данных.</li>
</ul>
</section>
<section id="этап-2-рандомизация" class="level2">
<h2 class="anchored" data-anchor-id="этап-2-рандомизация">Этап 2 – рандомизация</h2>
<p>На этой стадии ученые в два захода научились убирать индивидуальные особенности участников эксперимента.</p>
<p>Первая проблема – личная предвзятость. Думаю не секрет, что люди любят свои гипотезы и хотят в них верить сильнее чем стоило бы, поэтому часто выбирают решения в пользу своих убеждений, что касается и экспериментаторов, и подопытных. Как избавиться от предвзятости, если переключать мышление мы не умеем? – убрать у знание о том, данные о чем конкретно мы анализируем.</p>
<p>Так появилась концепция слепых тестов, а первое зафиксированное применение датируется 1784 в исследовании магнетизма у животных. Суть в том, что мы стороны эксперимента не должны знать кто получает воздействие, а кто нет, чтобы не было соблазна искать в данных подтверждение своим мыслям, в ущерб реальности.</p>
<p>Вторая проблема – как избавиться от индивидуальных особенностей единиц эксперимента. В 18-19 веках появляются значимые открытия в области статистики, а именно:</p>
<ul>
<li>В 1770-х Лапласс развил идею Арбутнота и впервые использовал что-то похожее на фреймворк статистической проверки гипотез, где мы выделяем 2 варианта – нулевую и альтернативную гипотезу и интерпретируем данные в пользу одной из них. Так появилась идея взаимно исключающих, но коллективно исчерпывающих сравнений.</li>
<li>С 1730-х по 1812 годы, Муавр, Гаусс и Лапласс формализуют и исследуют нормальное распределение и затем замечают, что биномиальное распределение в пределе стремится к нормальному. Так в 1812 году появляется первый частный случай центральной предельной теоремы, после чего активно будут появляться все новые улучшения, до того, как ЦПТ в общем виде не будет доказана в середине прошлого века (к слову, хороший <a href="https://www.youtube.com/watch?v=XTCjKGK1WeM">видос об истории ЦПТ</a>). Это позволило мыслить сторону того, что достаточно большое количество случайных наблюдений нейтрализует индивидуальные особенности каждого наблюдения.</li>
</ul>
<p>И какое это все имеет практическое отношение к AB тестам? А то, что эти три идеи говорят, что если мы зафиксируем какие-то ожидания и возьмем достаточно много случайных наблюдений, то сможем оценить эффект от воздействия. Так, в 1880-х годах, Чарльз Пирс в серии статей предлагает нечто, очень похожее на рандомизацию, которая, при достаточном числе наблюдений, позволяет считать, что индивидуальные особенности и прочие факторы среды нивелируются случайностью разделения подопытных на группы.</p>
</section>
<section id="этап-3-измеряем-случайность" class="level2">
<h2 class="anchored" data-anchor-id="этап-3-измеряем-случайность">Этап 3 – измеряем случайность</h2>
<p>Имея на руках базовые инструменты, ученые начали активно развивать свои подходы и в конце 19 – первой половине 20 века сформулировали основные идеи современных тестов.</p>
<p>В это время формируются основные, популярные сегодня, подходы к формированию статистического вывода:</p>
<ul>
<li>Байесовский – применимость байесовского статистического подхода к принятию решений доказал Абрахам Вальд. В данном подходе используются априорные знания, которые формируют некоторую статистическую модель и затем эта модель обновляется согласно наблюдаемым данным с помощью теоремы Байеса.</li>
<li>Частотный – первично его развивали Рональд Фишер, Джерси Нейман и Эгон Пирсон. Этот подход рассматривает наблюдаемые частоты как вероятности и переносит выводы из анализа наблюдаемых частот.</li>
<li>Правдоподобие – изначально эта школа не была отдельной и развивалась в рамках подхода Фишера к статистике, который предлагал метод максимизации правдоподобия. Позже методики развились в отдельное течение и первое систематическое, самостоятельное использование методов анализа правдоподобия можно найти у Энтони Эдвардса. Эта парадигма предполагает подбирать параметры статистической модели на основе наблюдаемых данных для оптимизации функции правдоподобия.</li>
</ul>
<p>Также, это было время настоящих суперзвезд статистики, вот даты открытия самых известных фактов:</p>
<ul>
<li>1904 Карл Пирсон разрабатывает тест – Хи-квадрат</li>
<li>1908 Уильям Госсет разрабатывать t-тест</li>
<li>1918 Фишер формализует понятие дисперсии</li>
<li>1923 Джерси Нейман описывает применимость рандомизации к проведению статистических экспериментов и предлагает фреймворк причинно-следственного анализа</li>
<li>1937 Джерси Нейман определил концепцию доверительных интервалов.</li>
<li>1935 Фишер формализует подходы к дизайну статистических экспериментов</li>
<li>1958 Кокс формулирует главную предпосылку экспериментов – SUTVA – требование о том, что каждый подопытный должен получать только один тип воздействия (или его отсутствие)</li>
<li>В 1974-1980 Дональд Рубин в серии статей расширяет фреймворк, предложенный Нейманом, который сейчас известен как rubin causal model и теперь является стандартом в вопросе причинно следственного анализа.</li>
<li>К середине 20 века у человечества уже были описаны все основные концепции, которые сейчас используются в AB тестах. Люди умели случайным образом составлять группы, оценивать параметры выборки и делать вывод о том, насколько наблюдаемые значения случайны.</li>
</ul>
</section>
<section id="этап-4-улучшаем-случайность" class="level2">
<h2 class="anchored" data-anchor-id="этап-4-улучшаем-случайность">Этап 4 – улучшаем случайность</h2>
<p>Казалось бы, вот уже все умеем считать и делать вывод о случайности или неслучайности явлений, что дальше? На самом деле, люди быстро столкнулись с проблемой, что хочется проверять влияние как можно более точечных факторов, а данных на всех не хватает, поэтому надо уметь получать достоверные результаты, с наименьшим количеством данных.</p>
<p>Изначально, теория вероятности, а особенно ЦПТ, сказали, что если мы соберем достаточно много наблюдений, то можем пренебречь факторами, которые влияют на каждое индивидуальное наблюдение. Теперь же ученые решили, что могут использовать известные факторы в своих целях. Основная идея следующая – вместо того, чтобы отбрасывать знание об испытуемых с помощью больших выборок, мы можем использовать это знание, чтобы сравнивать подобное с подобным. Для себя я называл это “улучшение случайности”, потому что люди стали придумывать способы использовать знания о случайных наблюдениях для улучшения своих статистических оценок параметров. Тут была проделана огромная работа, опишу лишь базовые и самые популярные методы:</p>
<ul>
<li>1960 Дональд Кампбел предлагает метод regression discontinuity design – где мы анализируем наблюдения в окрестности предполагаемого влияния</li>
<li>1983 Дональд рубин предлагает технику propensity score matching – которая предполагает изменять значимость наблюдений согласно их популярности в данных</li>
<li>1984 Орли Эшенфельтер и Дэвид Кард разрабатывают метод Diff-in-Diff, где мы используем данные о похожих наблюдениях для прогноза значений в целевых.<br>
</li>
<li>2000 Джуда Перл дал полное формальное определение инструментальных переменных – техники использования внешней независимой переменной для исключения влияния неизвестных факторов</li>
</ul>
<p>Отмечу, что это далеко не исчерпывающий список, но, как мне показалось, он хорошо показа идею, что люди стали активно улучшать методы выбора групп для сравнения. Также, обязательно надо отметить, что все техники ML стали активно использоваться для улучшения экспериментов, основных направления для использования – два: снизить дисперсию (т.е. сделать оценку более устойчивой) и убрать смещение (т.е. Сделать оценку более приближенной к реальности).</p>
<p>По-моему мнению, мы находимся на данном этапе. Сейчас мы умеем чудесно проводить реальные эксперименты и организовывать синтетические (такие, где результаты контрольной группы прогнозируются, а не берутся напрямую из эксперимента), но что же далее?</p>
</section>
<section id="этап-5-прогнозная-оптимизация" class="level2">
<h2 class="anchored" data-anchor-id="этап-5-прогнозная-оптимизация">Этап 5 – прогнозная оптимизация</h2>
<p>Это моя попытка угадать как дальше будут развиваться эксперименты. Напомню какой путь человечество прошло в плане экспериментов за последние 300 лет:</p>
<ul>
<li>Экспериментов нет – выводы о причинах и следствиях делаются из личного опыта и убеждений</li>
<li>Классические эксперименты – чтобы сделать вывод, надо разделить большое количество подопытных по группам случайным образом и использовать статистические процедуры для оценки эффекта и его значимости</li>
<li>Прогнозные эксперименты – можно оценивать эффект от воздействия прогнозируя поведение контрольной группы.</li>
</ul>
<p>В такой цепочке мне кажется абсолютно логичным следующий шаг – научиться оценивать возможные эффекты без осуществления какого-либо воздействия, т.е. чтобы сказать, что событие X меняет показатель Y на N% не нужно будет ни на кого влиять этим событием. Если это случится, то задачи оптимизации любых явлений станут делом техники.</p>
<p>Рассмотрим на примере бизнеса – сейчас на старте предприниматель выбирает некоторый набор гипотез и проверяет и стремится как можно быстрее их проверить, создавая бизнес модель, продукт и т.п, чтобы понять, что из этого сработает. В парадигме, где существует возможность оценить любой эффект без какого-либо эксперимента, предприниматель сможет описать параметры гипотезы, которую он хочет проверить и в ответе получит ожидаемый размер прибыли. И если такой механизм станет исправно существовать, то очень скоро появится другой, который будет генерировать вопросы и находить оптимальные решения, согласно прогнозам этой модели.</p>
<p>По сути, это упражнение уже сейчас делают много где, в том же бизнесе люди создают прогнозные бизнес-модели, ученые выдвигают гипотезы о каких-либо явлениях и т.п., но относительно простого механизма получить прогноз о сложной системе по заданным параметрам у нас сейчас нет.</p>
<p>Чтобы мое предложение “всезнающего черного ящика” не казалось слишком абсурдным, приведу примеры, где нечто-похожее уже используют:</p>
<ul>
<li><a href="https://www.hbs.edu/ris/Publication%2520Files/23-062_b8fbedcd-ade4-49d6-8bb7-d216650ff3bd.pdf">Ребята из гарварда</a> исследовали можно ли использовать chat-gpt для сбора данных о предпочтениях пользователей. По итогу, модель вполне успешно симулирует ответы реальных потребителей.</li>
<li>Большая компашка по исследованиям рынка <a href="https://kadence.com/how-large-language-models-are-changing-market-research/">пишет</a>, как LLM помогают им с проведением опросов. Если коротко, то на каждом этапе польза есть, от составления опросника, до имитации ответов и очистки данных.</li>
<li><a href="https://on-page.ai/pages/auto-optimize/">Приложение</a>, которое само оптимизирует SEO. LLM читает текст, генерирует ключевые слова и проверяет лучшие через поисковой движков, если повторить это несколько раз, то будут подобраны годные ключевые слова.</li>
<li><a href="https://blog.evolv.ai/enhancing-ux-design-process-ai">Подборка</a>, стартапов, которые улучшают UI с помощью прогнозов по пользовательскому поведению от моделек.</li>
<li><a href="https://sales-ninja.me/personalizations">Sales ninja</a> – ребята делают путь пользователя персональным</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pavelbaboshkin\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>